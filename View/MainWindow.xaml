<Window x:Class="ReturnToStonks.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:emoji="clr-namespace:Emoji.Wpf;assembly=Emoji.Wpf"
        xmlns:local="clr-namespace:ReturnToStonks"
        xmlns:i="clr-namespace:Microsoft.VisualBasic;assembly=Microsoft.VisualBasic.Core"
        mc:Ignorable="d"
        Title="MainWindow" Height="450" Width="800">
  <Grid>
    <Grid.Resources>
      <local:DateOutputConverter x:Key="DateOutputConverter"/>
      <local:IsTrueVisibilityConverter x:Key="IsTrueVisibilityConverter"/>
      <local:CellBackgroundConverter x:Key="CellBackgroundConverter"/>
      <!--<local:CellTextDecorationsConverter x:Key="CellTextDecorationsConverter"/>-->
    </Grid.Resources>
    <Grid.ColumnDefinitions>
      <ColumnDefinition/>
      <ColumnDefinition/>
    </Grid.ColumnDefinitions>

    <Grid.RowDefinitions>
      <RowDefinition Height="40"/>
      <RowDefinition/>
      <RowDefinition Height="28"/>
      <RowDefinition Height="75"/>
    </Grid.RowDefinitions>

    <Label Content="Incomes" Grid.Column="0"/>
    <Label Content="Expenses" Grid.Column="1"/>

    <DataGrid ItemsSource="{Binding Incomes}" MouseDoubleClick="DataGrid_MouseDoubleClick"
              Grid.Column="0" Grid.Row="1">
      <DataGrid.Columns>
        <DataGridTemplateColumn Width="16">
          <DataGridTemplateColumn.CellTemplate>
            <DataTemplate>
              <emoji:TextBlock Text="{Binding Category.Symbol}" Margin="0,0,-5,1"/>
            </DataTemplate>
          </DataGridTemplateColumn.CellTemplate>
        </DataGridTemplateColumn>
        <DataGridTemplateColumn Width="25">
          <DataGridTemplateColumn.CellTemplate>
            <DataTemplate>
              <TextBlock Visibility="{Binding IsRecurring, Converter={StaticResource IsTrueVisibilityConverter}}"
                   Text="&#10227;" FontSize="20" FontWeight="ExtraBold" HorizontalAlignment="Right" />
            </DataTemplate>
          </DataGridTemplateColumn.CellTemplate>
        </DataGridTemplateColumn>
        <DataGridTextColumn Binding="{Binding Date, Converter={StaticResource DateOutputConverter}}"/>
        <DataGridTextColumn Binding="{Binding Purpose}" Width="*">
          <DataGridTextColumn.CellStyle>
            <Style TargetType="{x:Type DataGridCell}" BasedOn="{StaticResource DataGridCellStyle}">
              <Setter Property="TextBlock.TextAlignment" Value="Left"/>
              <Setter Property="Background" Value="{Binding Date, Converter={StaticResource CellBackgroundConverter}}"/>
            </Style>
          </DataGridTextColumn.CellStyle>
        </DataGridTextColumn>
        <DataGridTextColumn Binding="{Binding Amount, StringFormat={}{0:C2}}"/>
      </DataGrid.Columns>

      <DataGrid.CellStyle>
        <Style TargetType="{x:Type DataGridCell}" BasedOn="{StaticResource DataGridCellStyle}">
          <Setter Property="Background" Value="{Binding Date, Converter={StaticResource CellBackgroundConverter}}"/>
        </Style>
      </DataGrid.CellStyle>
    </DataGrid>
    <TextBlock Text="{Binding IncomesSum, StringFormat=Sum: {0:C2}}" Grid.Row="2" Style="{StaticResource DataGridTextBlockStyle}"/>

    <DataGrid ItemsSource="{Binding Expenses}" MouseDoubleClick="DataGrid_MouseDoubleClick"
              Grid.Column="1" Grid.Row="1">
      <DataGrid.Columns>
        <DataGridTemplateColumn Width="16">
          <DataGridTemplateColumn.CellTemplate>
            <DataTemplate>
              <emoji:TextBlock Text="{Binding Category.Symbol}" Margin="0,0,-5,1"/>
            </DataTemplate>
          </DataGridTemplateColumn.CellTemplate>
        </DataGridTemplateColumn>
        <DataGridTemplateColumn Width="25">
          <DataGridTemplateColumn.CellTemplate>
            <DataTemplate>
              <TextBlock Visibility="{Binding IsRecurring, Converter={StaticResource IsTrueVisibilityConverter}}"
                         Text="&#10227;" FontSize="20" FontWeight="ExtraBold" HorizontalAlignment="Right" />
            </DataTemplate>
          </DataGridTemplateColumn.CellTemplate>
        </DataGridTemplateColumn>
        <DataGridTextColumn Binding="{Binding Date, Converter={StaticResource DateOutputConverter}}"/>
        <DataGridTextColumn Binding="{Binding Purpose}" Width="*">
          <DataGridTextColumn.CellStyle>
            <Style TargetType="{x:Type DataGridCell}" BasedOn="{StaticResource DataGridCellStyle}">
              <Setter Property="TextBlock.TextAlignment" Value="Left"/>
              <Setter Property="Background" Value="{Binding Date, Converter={StaticResource CellBackgroundConverter}}"/>
            </Style>
          </DataGridTextColumn.CellStyle>
        </DataGridTextColumn>
        <DataGridTextColumn Binding="{Binding Amount, StringFormat={}{0:C2}}"/>
      </DataGrid.Columns>
      
      <DataGrid.CellStyle>
        <Style TargetType="{x:Type DataGridCell}" BasedOn="{StaticResource DataGridCellStyle}">
          <Setter Property="Background" Value="{Binding Date, Converter={StaticResource CellBackgroundConverter}}"/>
        </Style>
      </DataGrid.CellStyle>
    </DataGrid>
    <TextBlock Text="{Binding ExpensesSum, StringFormat=Sum: {0:C2}}" Grid.Row="2" Grid.Column="1" Style="{StaticResource DataGridTextBlockStyle}"/>

    <Button Content="+ new transaction" Command="{Binding AddTransactionCommand}" Grid.ColumnSpan="2" Grid.Row="3"/>
  </Grid>
</Window>